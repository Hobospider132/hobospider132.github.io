name: Deploy Minified Site

on:
  push:
    branches:
      - main  # Run this workflow when pushing to the main branch

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install Minification Tools
        run: |
          npm install -g html-minifier csso-cli uglify-js

      - name: Minify HTML
        run: find . -name "*.html" -exec html-minifier --collapse-whitespace --remove-comments --minify-css true --minify-js true --input-dir ./ --output-dir ./ {} +

      - name: Minify CSS
        run: find . -name "*.css" -exec csso {} --output {} +

      - name: Minify JS
        run: find . -name "*.js" -exec uglifyjs {} -o {} --compress --mangle +

      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages  # Deploy to the gh-pages branch
          folder: .         # Deploy the root directory (no build folder needed)
          clean: true       # Remove old files

